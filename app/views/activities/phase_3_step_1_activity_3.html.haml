.container
	.row
		.col-sm-12
			%ol.breadcrumb
				%li
					= link_to 'Dashboard', dashboard_index_path
				%li
					= link_to 'Phase 3', phase_path( 3 )
				%li
					= link_to 'Step 1', phase_step_path( @phase, @step )
				%li
					Activity 3: Treatment Adaptations Table
	.row
		.col-sm-12
			%h1
				Activity 3: Treatment Adaptations Table


			%p
				To review instructions, see
				= link_to 'Phase 3 Step 1 guide', phase_step_path( @phase, @step )
		%table.table.table-bordered	
			%thead
				%th
					Specify reason(s) for the adaptation
				%th
					Identify any specific concerns about the adaptation
				%th
					How will concerns be addressed?
				%th
					Specify how the adaptation will be made
				%th
					Who will carry out the adaptation?
			%tbody
				= form_tag responses_path, :id => "adaptationsForm" do
					= hidden_field_tag :activity_id, @activity.id
					- @activity.questions.find_by( seq: 1 ).prompts.each do |prompt|
						%tr
							%td
								= check_box_tag "question_answers[#{@activity.questions.find_by( seq: 1 ).id}][]", prompt.content, @current_agency.responses.where( question_id: @activity.questions.find_by( seq: 1 ).id ).pluck( :content ).include?( prompt.content )
								= prompt.content

							- if prompt.id == 71
								%td{:rowspan => "5"}									
									- @activity.questions.find_by( seq: 3 ).prompts.each do |prompt|
										= check_box_tag "question_answers[#{@activity.questions.find_by( seq: 3 ).id}][]", prompt.content, @current_agency.responses.where( question_id: @activity.questions.find_by( seq: 3 ).id ).pluck( :content ).include?( prompt.content )
										= prompt.content
										%br
									%br
									List concerns:
									= text_area_tag "question_answers[#{@activity.questions.find_by( seq: 4 ).id}]", @current_agency.responses.where( question_id: @activity.questions.find_by( seq: 4 ).id ).first.try( :content )

								%td{:rowspan => "5"}							
									- @activity.questions.find_by( seq: 5 ).prompts.each do |prompt|

										= check_box_tag "question_answers[#{@activity.questions.find_by( seq: 5 ).id}][]", prompt.content, @current_agency.responses.where( question_id: @activity.questions.find_by( seq: 5 ).id ).pluck( :content ).include?( prompt.content )
										= prompt.content
										%br
									%br
									If "Address concern" chosen, please list how:
									= text_area_tag "question_answers[#{@activity.questions.find_by( seq: 6 ).id}]", @current_agency.responses.where( question_id: @activity.questions.find_by( seq: 6 ).id ).first.try( :content )

								%td{:rowspan => "5"}							
									= text_area_tag "question_answers[#{@activity.questions.find_by( seq: 7 ).id}]", @current_agency.responses.where( question_id: @activity.questions.find_by( seq: 7 ).id ).first.try( :content ), :rows => "10"

								%td{:rowspan => "5"}							
									- @activity.questions.find_by( seq: 8 ).prompts.each do |prompt|

										= check_box_tag "question_answers[#{@activity.questions.find_by( seq: 8 ).id}][]", prompt.content, @current_agency.responses.where( question_id: @activity.questions.find_by( seq: 8 ).id ).pluck( :content ).include?( prompt.content )
										= prompt.content
										%br
									%br
									Other:
									= text_area_tag "question_answers[#{@activity.questions.find_by( seq: 9 ).id}]", @current_agency.responses.where( question_id: @activity.questions.find_by( seq: 9 ).id ).first.try( :content )


					%tr
						%td
							Other factors: 
							%br
							= text_area_tag "question_answers[#{@activity.questions.find_by( seq: 2 ).id}]", @current_agency.responses.where( question_id: @activity.questions.find_by( seq: 2 ).id ).first.try( :content )

					= submit_tag 'Submit', class: 'btn btn-primary', style: "display:none;"

		%p
			.btn.btn-primary#adaptationsButton
				Save
			-# Had to implement separately positioned button that triggers for submit via jquery because submit_tag was displaying at top of page






